{% extends 'base.html' %} {% block title %}Gestión de Citas{% endblock %} {%
block content %}
<h1>Gestión de Citas</h1>

<div class="row">
  <div class="col-md-6">
    <h3>Citas para Hoy</h3>
    {% if citas_hoy %}
    <table class="table table-hover">
      <thead>
        <tr>
          <th>Cliente</th>
          <th>Animal</th>
          <th>Servicio</th>
          <th>Estado</th>
        </tr>
      </thead>
      <tbody>
        {% for cita in citas_hoy %}
        <tr>
          <td>{{ cita[1] or 'N/A' }}</td>
          <td>{{ cita[2] or 'N/A' }}</td>
          <td>{{ cita[3] or 'N/A' }}</td>
          <td>{{ cita[5] or 'N/A' }}</td>

        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% else %}
    <div class="alert alert-info">No hay citas para hoy</div>
    {% endif %}
  </div>

  <div class="col-md-6">
    <h3>Próximas Citas</h3>
    {% if citas_proximas %}
    <table class="table table-hover">
      <thead>
        <tr>
          <th>Fecha</th>
          <th>Cliente</th>
          <th>Servicio</th>
          <th>Estado</th>
        </tr>
      </thead>
      <tbody>
        {% for cita in citas_proximas %}
        <tr>
          <td>{{ cita[4].strftime('%d/%m/%Y') }}</td>
          <td>{{ cita[1] or 'N/A' }}</td>
          <td>{{ cita[3] or 'N/A' }}</td>
          <td>{{ cita[5] or 'N/A' }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% else %}
    <div class="alert alert-info">No hay citas próximas</div>
    {% endif %}
  </div>
</div>

<button
  class="btn btn-primary"
  data-bs-toggle="modal"
  data-bs-target="#nuevaCitaModal"
>
  Agendar Nueva Cita
</button>

<!-- Modal para nueva cita -->
<div class="modal fade" id="nuevaCitaModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Nueva Cita</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <form action="{{ url_for('agendar_cita') }}" method="POST">
          <!-- Datos del Cliente -->
          <div class="mb-3">
            <h5>Datos del Cliente</h5>
            <div class="row">
              <div class="col-md-6">
                <label class="form-label">Nombre del Cliente*</label>
                <input
                  type="text"
                  name="nombre_cliente"
                  class="form-control"
                  required
                />
              </div>
              <div class="col-md-6">
                <label class="form-label">Teléfono</label>
                <input
                  type="text"
                  name="telefono_cliente"
                  class="form-control"
                />
              </div>
            </div>
            <div class="mt-2">
              <label class="form-label">Dirección</label>
              <input
                type="text"
                name="direccion_cliente"
                class="form-control"
              />
            </div>
          </div>

          <!-- Datos del Animal -->
          <div class="mb-3">
            <h5>Datos del Animal</h5>
            <div class="row">
              <div class="col-md-6">
                <label class="form-label">Nombre del Animal*</label>
                <input
                  type="text"
                  name="nombre_animal"
                  class="form-control"
                  required
                />
              </div>
              <div class="col-md-6">
                <label class="form-label">Especie*</label>
                <input
                  type="text"
                  name="especie_animal"
                  class="form-control"
                  required
                />
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-4">
                <label class="form-label">Raza</label>
                <input type="text" name="raza_animal" class="form-control" />
              </div>
              <div class="col-md-4">
                <label class="form-label">Edad (años)</label>
                <input
                  type="number"
                  name="edad_animal"
                  class="form-control"
                  min="0"
                />
              </div>
              <div class="col-md-4">
                <label class="form-label">Sexo</label>
                <select name="sexo_animal" class="form-select">
                  <option value="">No especificado</option>
                  <option value="Macho">Macho</option>
                  <option value="Hembra">Hembra</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Datos de la Cita -->
          <div class="mb-3">
            <h5>Datos de la Cita</h5>
            <div class="row">
              <div class="col-md-6">
                <label class="form-label">Fecha*</label>
                <input
                  type="date"
                  name="fecha_cita"
                  class="form-control"
                  required
                  min="{{ datetime.date.today().isoformat() }}"
                />
              </div>
              <div class="col-md-6">
                <label class="form-label">Hora*</label>
                <input
                  type="time"
                  name="hora_cita"
                  class="form-control"
                  required
                />
              </div>
            </div>
            <div class="mt-2">
              <label class="form-label">Servicio/Motivo*</label>
              <textarea
                name="motivo_cita"
                class="form-control"
                rows="3"
                required
              ></textarea>
            </div>
            <div class="mt-2">
              <label class="form-label">Observaciones</label>
              <textarea
                name="observaciones_cita"
                class="form-control"
                rows="2"
              ></textarea>
            </div>
          </div>

          <button type="submit" class="btn btn-primary">Agendar Cita</button>
        </form>
      </div>
    </div>
  </div>
</div>
{% endblock %}
